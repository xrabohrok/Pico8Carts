pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
-- logo
logo_pos = {x=18, y=22}

echo_count = 30
echo_step = 3

start_width = 100
start_height = 32

curr_width = start_width

spin_phase = 180
current_phase = 0
flipped = false
x_disp = 0


function draw_logo(x,y, my_phase, blue_alt, green_alt)
	pal (1, blue_alt)
	pal (11, green_alt)
	
	curr_width = start_width * 
	cos(my_phase/
		spin_phase)
		
	x_disp = start_width/2 * 
	cos(my_phase/
		spin_phase + .5) + start_width/2
	
	sspr(8,0, 55,15, 
		x + x_disp  
		, y, 
 	curr_width , 
 	start_height)	
 pal()
end

function draw_logo_echo(x,y)
	y_down = y + echo_count 
 	* (echo_step)
 i = 0
 while i < echo_count do
 	draw_logo(x, 
 		y_down - i * echo_step,
 		current_phase - 
 			(echo_count - i),
 			1,2
 		)
 		
 	i += 1
 end
end



-->8
--update and draw
function _update()
	
 current_phase += 1
 if current_phase > spin_phase then
 	current_phase = 0
 	flipped = not flipped
 end

end

function _draw()
 cls()
 palt(0, true)
 
 --draw backwards
 draw_logo_echo(logo_pos.x, logo_pos.y)
 
 draw_logo(logo_pos.x ,logo_pos.y, 
 current_phase, 12, 11)
 
 --hype man
 draw_man(100, 78)
 
 -- text
 draw_wiggle_text("testing 1 2 3", 20, 20)

end
-->8
--hypman

mouth_phases = {34, 48}
body_phases = {50, 36, 52, 38}

body_change_rate = 20
curr_body = 1

per_cycle = 4
iter = 0
curr_cycle = 1

head_pos = {x=78, y=78}
body_pos = {x=78, y=90}

function draw_man(x, y)
	head_pos.x = x
	head_pos.y = y
	body_pos.x = x
	body_pos.y = y+6
	
	draw_body()
	draw_head()
end

function draw_head()

	talking = current_phase > 
		spin_phase/2
	iter += 1	
	
	if talking then 
	
		if iter > per_cycle then
			iter = 0
			curr_cycle += 1
			if curr_cycle > #mouth_phases then
				curr_cycle = 1
			end
		end
		spr(mouth_phases[curr_cycle]
							, head_pos.x, head_pos.y, 2,1)
	else
		spr(32, head_pos.x, head_pos.y, 2, 1)
	
	end	

end

function draw_body()
	
	change_bit = current_phase % body_change_rate 
				== 0
				
	if change_bit then
		curr_body = flr(rnd(#body_phases)) + 1
	end
	
	spr(body_phases[curr_body],
		body_pos.x,
		body_pos.y,
		2,1)
end

-->8
--wiggle text

text_period = spin_phase /4
text_amplitude = 5

function draw_wiggle_text	(
	text, x, y)
	
	text_phase = current_phase % text_period
	
	wobble_text(text,x,y,3,5)
	wobble_text(text,x,y,2,5)
	wobble_text(text,x,y,1,5)
	wobble_text(text,x,y,0,7)	
	
end

function wobble_text(text,x, y, phase_disp, my_col)
	print(text, 
		x + text_amplitude * cos((text_phase-phase_disp)
			/text_period),
		y + text_amplitude * sin((text_phase-phase_disp)
			/text_period),
		my_col)
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000001100000000000001111000bbb000000000bbb000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000000111100001100001111111000bbb0000000bbb0000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000011111100011000111000111000bbb00000bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070000010000100011000110000011000bbb0000bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000100001000110011000000000000bbb000bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000011000011001100110000000000000bbbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000110000110011001100000000000000bbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000111111110011001100000000000000bbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000011111111001100110000000000000bbb0bbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001100001100110011100000110000bbb000bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000110000110011000110000111000bbb00000bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000011000011001100011111111000bbb0000000bbb0000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001100001100110000011111000bbb000000000bbb000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000908800000099000000000003306666ddd660000330006ddd60003300000000000000000000000000000000000000000000000000000000000000000
00000099998800000099999990880000336600ddddd6600036066dddd60663300000000000000000000000000000000000000000000000000000000000000000
00000999999990000099999c98800000000000ddddd0630000660ddddd6600000000000000000000000000000000000000000000000000000000000000000000
00009c9c9998800000b0b09999990000000000ddddd0330000000ddddd0000000000000000000000000000000000000000000000000000000000000000000000
0009999999998800000b0b9999880000000000ccccc0000000000ccccc0000000000000000000000000000000000000000000000000000000000000000000000
00099999990000000099999999988000000000cc0cc0000000000cc0cc0000000000000000000000000000000000000000000000000000000000000000000000
00000990000000000099999990000000000001110111000000001110111000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0099000000000000000066ddd66000000000066ddd66000000000000000000000000000000000000000000000000000000000000000000000000000000000000
099999990880000000066ddddd6600000000066d33d6600000000000000000000000000000000000000000000000000000000000000000000000000000000000
099999c98800000000660ddddd0630000000006633d0630000000000000000000000000000000000000000000000000000000000000000000000000000000000
00b0b9999990000003600ddddd033000000000ddddd0330000000000000000000000000000000000000000000000000000000000000000000000000000000000
099999999880000003300ccccc000000000000ccccc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000
099999999988000000000cc0cc000000000000cc0cc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00099000000000000000111011100000000001110111000000000000000000000000000000000000000000000000000000000000000000000000000000000000
